--VERSIONE MIA
--UPDATE DO33_DOCCORPORIF SET DO33_QTA1MOV = DO31_QTA1LANC
SELECT DO33_QTA1MOV, DO31_QTA1LANC, * 
FROM DO11_DOCTESTATA DO11_ODL
INNER JOIN DO33_DOCCORPORIF ON
DO33_DITTA_CG18=DO11_ODL.DO11_DITTA_CG18 AND
DO33_NUMREG_CO99=DO11_ODL.DO11_NUMREG_CO99 
INNER JOIN DO31_DOCCORPOORD DO31_OV ON
DO31_OV.DO31_DITTA_CG18=DO33_DITTA_CG18 AND
DO31_OV.DO31_NUMREG_CO99=DO33_NUMREGRIF_CO99 AND
DO31_OV.DO31_PROGRIGA=DO33_PROGRIGARIF_DO30 
INNER JOIN DO11_DOCTESTATA DO11_OV ON
DO11_OV.DO11_DITTA_CG18=DO33_DITTA_CG18 AND
DO11_OV.DO11_NUMREG_CO99=DO33_NUMREGRIF_CO99
WHERE 
--DO11_ODL.DO11_DITTA_CG18 = 2 AND
DO11_ODL.DO11_TIPODOC = 24 AND DO11_ODL.DO11_STIPODOC = 20 AND DO11_OV.DO11_TIPODOC=21 AND DO11_OV.DO11_STIPODOC = 1

--VERSIONE DAVIDE ZINI
--UPDATE DO33_DOCCORPORIF
--SET DO33_QTA1MOV= DO30_ODL.DO30_QTA1
SELECT       DO11_OC.DO11_NUMREG_CO99, DO11_OC.DO11_NUMDOC, DO11_OC.DO11_DATADOC, DO11_OC.DO11_DOCUM_MG36, DO11_OC.DO11_TIPODOC, 
DO31_DOCCORPOORD.DO31_QTA1LANC, DO33_QTA1MOV, DO30_OC.DO30_QTA1, DO30_ODL.DO30_QTA1 AS QTA_ODL
FROM         DO11_DOCTESTATA AS DO11_OC
INNER JOIN DO30_DOCCORPO AS DO30_OC
      ON DO11_OC.DO11_DITTA_CG18 = DO30_OC.DO30_DITTA_CG18 
      AND DO11_OC.DO11_NUMREG_CO99 = DO30_OC.DO30_NUMREG_CO99 
INNER JOIN DO31_DOCCORPOORD 
      ON DO30_OC.DO30_DITTA_CG18 = DO31_DOCCORPOORD.DO31_DITTA_CG18 
      AND DO30_OC.DO30_NUMREG_CO99 = DO31_DOCCORPOORD.DO31_NUMREG_CO99 
      AND DO30_OC.DO30_PROGRIGA = DO31_DOCCORPOORD.DO31_PROGRIGA 
INNER JOIN DO33_DOCCORPORIF AS DO33_ODL
      ON DO30_OC.DO30_DITTA_CG18 = DO33_ODL.DO33_DITTA_CG18
      AND  DO30_OC.DO30_NUMREG_CO99 = DO33_ODL.DO33_NUMREGRIF_CO99 
      AND  DO30_OC.DO30_PROGRIGA = DO33_ODL.DO33_PROGRIGARIF_DO30
INNER JOIN DO30_DOCCORPO AS DO30_ODL
      ON DO30_ODL.DO30_DITTA_CG18=DO33_ODL.DO33_DITTA_CG18
      AND DO30_ODL.DO30_NUMREG_CO99 = DO33_ODL.DO33_NUMREG_CO99
      AND DO30_ODL.DO30_PROGRIGA = DO33_ODL.DO33_PROGRIGA
INNER JOIN DO11_DOCTESTATA AS DO11_ODL
      ON DO11_ODL.DO11_DITTA_CG18=DO30_ODL.DO30_DITTA_CG18
      AND DO11_ODL.DO11_NUMREG_CO99=DO30_ODL.DO30_NUMREG_CO99

where DO11_ODL.do11_tipodoc = 24 and DO11_ODL.do11_stipodoc = 20
